> library(aplore3)
> example(chdage)

chdage> head(chdage)
  id age agegrp chd
1  1  20  20-39  No
2  2  23  20-39  No
3  3  24  20-39  No
4  4  25  20-39  No
5  5  25  20-39 Yes
6  6  26  20-39  No

chdage> ## Figure 1.1
chdage> plot(as.integer(chd)-1 ~ age,
chdage+      pch = 20,
chdage+      ylab = "Coronary heart disease",
chdage+      xlab = "Age (years)",
chdage+      data = chdage,
chdage+      main = "Figure 1.1")

chdage> ## Table 1.2
chdage> with(chdage, addmargins(table(agegrp)))
agegrp
20-39 30-34 35-39 40-44 45-49 50-54 55-59 60-69   Sum 
   10    15    12    15    13     8    17    10   100 

chdage> with(chdage, addmargins(table(agegrp, chd)))
       chd
agegrp   No Yes Sum
  20-39   9   1  10
  30-34  13   2  15
  35-39   9   3  12
  40-44  10   5  15
  45-49   7   6  13
  50-54   3   5   8
  55-59   4  13  17
  60-69   2   8  10
  Sum    57  43 100

chdage> (Means <- with(chdage, tapply(as.integer(chd)-1, list(agegrp), mean)))
    20-39     30-34     35-39     40-44     45-49     50-54     55-59     60-69 
0.1000000 0.1333333 0.2500000 0.3333333 0.4615385 0.6250000 0.7647059 0.8000000 

chdage> ## Figure 1.2
chdage> midPoints <- c(24.5, seq(32, 57, 5), 64.5)

chdage> plot(midPoints, Means, pch = 20,
chdage+      ylab = "Coronary heart disease (mean)",
chdage+      xlab = "Age (years)", ylim = 0:1,
chdage+      main = "Figure 1.2")

chdage> lines(midPoints, Means)

chdage> ## Table 1.3
chdage> summary( glm( chd ~ age, family = binomial, data = chdage ))

Call:
glm(formula = chd ~ age, family = binomial, data = chdage)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.9718  -0.8456  -0.4576   0.8253   2.2859  

Coefficients:
            Estimate Std. Error z value Pr(>|z|)    
(Intercept) -5.30945    1.13365  -4.683 2.82e-06 ***
age          0.11092    0.02406   4.610 4.02e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 136.66  on 99  degrees of freedom
Residual deviance: 107.35  on 98  degrees of freedom
AIC: 111.35

Number of Fisher Scoring iterations: 4

> 
